<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>RedVector: Online Safety Training</title>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/1.14.2/TweenMax.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.3/ScrollMagic.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.3/plugins/animation.gsap.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.3/plugins/debug.addIndicators.js"></script>
    <script src="assets/js/anime.min.js"></script>
    <script src="assets/js/jquery-qwerty.min.js"></script>

    <link href="styles/stylesheets/screen.css" media="screen, projection" rel="stylesheet" text="text/css" />
    <!--[if IE]>
        <link href="/styles/stylesheets/ie.css" meda="screen, projection" rel="stylesheet" type="text/css" />
    <![endif]-->

    <script>
        // let's get the ScrollMagic stuff underway
        var controller = new ScrollMagic.Controller();

        $(function() {
            // lift main container's width, use this to scale EVERYTHING
            var mainContainer = $('#container');
            var containerWidth = mainContainer.width();

            // variables to store ratios
            var topRatio = 1223/1945;
            var midRatio = 1292/1930;
            var bottomRatio = 540/1945;

            // calculate heights by multiplying current container width by appropriate ratios
            var topHeight = containerWidth * topRatio;
            var midHeight = containerWidth * midRatio;
            var bottomHeight = containerWidth * bottomRatio;

            console.log( "Top height = " + topHeight );
            console.log( "Mid Height = "+midHeight);
            console.log( "Bottom height ="+bottomHeight);

            // finally, let's hard-code the heights of the "panes"
            $('#top-container').css('height', topHeight);
            $('.middle-container').css('height', midHeight);
            $('#bottom-container').css('height', bottomHeight);

            // let's create an object to contain all the asset ratios
            var ratios = {
                dozer : 476/1920,
                sign : 328/1920,
                cone: 297/1920,
                crane: 408/1920,
                gearLarge: 334/1920,
                gearMedium: 241/1920,
                gearSmall: 284/1920,
                onlineSafety : 1665/1920,
                topBlurb : 825/1920,
                humanHeader: 1420/1920,
                left: 497/1920,
                right: 537/1920,
                fiscalImpact: 1418/1920,
                belowHeader: 1171/1920,
                citations: 626/1920,
                solution: 1415/1920,
                solutionLeft: 589/1920,
                solutionRight: 578/1920,
                yellowArrow: 336/1920,
                leftHand: 246/1920,
                rightHand: 337/1920,
                footerLinks: 1752/1920
            }

            // let's make a function to handle all this resizing business
            setWidth = function( className, ratio, parentWidth ) {
                $('.'+className).css('width', ratio * parentWidth);
            }
            // alright, let's iterate through our "ratios" object, using its keys to target various elements
            for ( var element in ratios ) {
                if ( ratios.hasOwnProperty(element) ) {
                    setWidth( element, ratios[element], containerWidth );
                }
            }
            
            // function for resizing font-size based on containing div's width
            resizeFont = function ( container, element, size ) {
                var fontSize = $(container).width() * size;
                $(container + " " + element).css('font-size', fontSize);
            }
            resizeFont( '.onlineSafety', 'h1', 0.09 );
            resizeFont('.onlineSafety', 'p', 0.05);
            resizeFont('.topBlurb', 'p', 0.045);
            resizeFont('.humanCost', 'h2', 0.07);
            resizeFont('.humanCost', '.left', 0.02);
            resizeFont('.humanCost', '.right', 0.02);
            resizeFont('.humanCost', '.countingNumbers', 0.06);
            resizeFont('#fiscal-impact', '.fiscalImpact', 0.07);
            resizeFont('#fiscal-impact', '.belowHeader', 0.018);
            resizeFont('#fiscal-impact', '.citations', 0.017);
            resizeFont('#fiscal-impact', '.big', 0.058);
            resizeFont('#the-solution', '.solution', 0.07);
            resizeFont('#the-solution', '.solutionLeft', 0.019);
            resizeFont('#the-solution', '.solutionRight', 0.017);
            resizeFont('#the-solution', '.big', 0.058);
            resizeFont('#bottom-container', '.footerLinks', 0.01);
        });
    </script>
</head>

<body>
    <div id="container">
        <div id="top-container" class="pane">
            <div class="onlineSafety">
                <h1>Online Safety Training:</h1>
                <p class="blue-header">Making the Case for Investing in Health,<br />Safety and Environment Training</p>
            </div>
            <div class="topBlurb">
                <p class="blue-body">
                    Thousands of American workers sustain serious<br />
                    injuries or die on the job every year. These<br />
                    accidents not only damage families and<br />
                    diminish worksite morale, but also cost<br />
                    companies millions.  Yet, many firms continue<br />
                    to underinvest in safety training programs,<br />
                    putting both employees and the future of the<br />
                    organization at risk.
                </p>
            </div>
        </div>
        <div class="middle-container pane" id="human-cost">
            <div class="humanCost">
                <h2 class="humanHeader blue-header">THE HUMAN COST</h2>
                <p class="left">
                    Approximately<br />
                    <span class="countingNumbers" id="numbersLeft" data-number="4836">0</span>
                    workers perished on<br />
                    worksites in 2015,<br />
                    capping off two<br />
                    consecutive years of<br />
                    increasing fatal injury<br />
                    figures.
                </p>
                <p class="right">
                    Roughly<br />
                    <span class="countingNumbers" id="numbersRight" data-number="187000">0</span>
                    more sustained serious<br />
                    injuries over the same span,<br />
                    falling victim to common<br />
                    safety oversights such as<br />
                    lack of proper fall<br />
                    protection or hazard<br />
                    communication.
                </p>
            </div>
            <img src="assets/bulldozer.png" class="dozer" />
            <img src="assets/sign.png" class="sign" />
            <img src="assets/cone.png" class="cone" />
            <img src="assets/crane-thing.png" class="crane" />
            <script>
                // grab current infographic width, for scaling of duration and offsets
                var containerWidth =  $('#container').width();

                incrementCount = function ( element, rate, interval ) {
                    var numHolder = $(element);
                    var number = parseInt( numHolder.html() );
                    var target = parseInt( numHolder.data("number") );

                    if ( number < target ) {
                        number+=rate;
                        numHolder.html(number);
                    } else {
                        clearInterval(interval);
                    }
                }

                // attach a scene who's "progress" event will be used to increment the counting numbers
                var leftCount = new ScrollMagic.Scene({
                    triggerElement: "#human-cost",
                    duration: 800/1920*containerWidth
                })
                    .addTo(controller);
                // register callback for "progress" event
                leftCount.on("progress", function(event) {
                    var humanCostLeftCounter = setInterval( incrementCount, 50, "#numbersLeft", 6, humanCostLeftCounter );
                });

                var rightCount = new ScrollMagic.Scene({
                    triggerElement: "#human-cost",
                    duration: 800/1920*containerWidth
                })
                    .addTo(controller);
                // register callback for "progress" event
                rightCount.on("progress", function(event) {
                    var humanCostRightCounter = setInterval( incrementCount, 50, "#numbersRight", 250, humanCostRightCounter );
                });

                // build out a scene to animate the bulldozer
                var dozerScene = new ScrollMagic.Scene({
                    triggerElement: "#human-cost",
                    duration: 800/1920*containerWidth,
                    offset: 300/1920*containerWidth
                })
                    .setTween("#human-cost .dozer", {left: "24%"})
                    .addTo(controller);
                

                var craneScene = new ScrollMagic.Scene({
                    triggerElement: "#human-cost",
                    duration: 1200/1920*containerWidth,
                    offset: 225/1920*containerWidth
                })
                    .setTween("#human-cost .crane", {left: "65%"})
                    .addTo(controller);
            </script>
        </div>
        <div class="middle-container pane" id="fiscal-impact">
            <div>
                <h2 class="fiscalImpact blue-header">THE FISCAL IMPACT</h2>
                <p class="belowHeader">
                    Last year, the Occupational Safety and Health Administration and its state<br />
                    affiliates conducted <span class="yellow">more than 75,000 inspections and distributed over<br />
                    32,000 citations</span> for violations ranging from faulty wiring to ineffective<br />
                    hazard signage. Each citation came with a minimum fine of $12,675.
                </p>
                <p class="citations">
                    An autoparts maker in Ohio incurred the<br />
                    largest financial penalty, receiving<br />
                    <span class="big">57 citations</span>
                    for a total of <span class="yellow">$3.42 million.</span>
                </p>
            </div>
            <img src="assets/gear-medium.png" class="gearMedium" />
            <img src="assets/gear-large.png" class="gearLarge" />
            <img src="assets/gear-small.png" class="gearSmall" />
            <div id="drawn-arrow">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 331.65 315.92" class="yellowArrow">
                    <defs>
                        <linearGradient id="left-to-right">
                            <stop id="stopcolor" offset="0" stop-color="#fdc00f"></stop>
                            <stop offset="0" stop-color="#2a66b0"></stop>
                        </linearGradient>
                    </defs>
                        
                    <path class="arrowPoints" fill="url(#left-to-right)" stroke-width="1" opacity="1"  d="M331.65,0,304.2,60,294,48.23l-63,56.26-53.48,91.23-90.82,6.76L27.92,314.86,0,315.92,71.58,179.49l91.58-6.8L212.81,88.5l65.48-58.45-10-11.57Z"/>

                </svg>
            </div>
            
            <script>
                var fill = 0;
                function animateIt(){
                    let el = document.getElementById('stopcolor');
                    console.log(fill);
                    console.log(fill <= 1);
                    if(fill <= 1){
                        fill += .002;
                        el.setAttribute("offset", fill);
                        setTimeout(animateIt, 3);
                    }
                }
                function startAnimateIt(){
                    fill = 0;
                    document.getElementById('stopcolor').setAttribute("offset", 0);
                    animateIt();
                }


                // grab current infographic width, for scaling of duration and offsets
                var containerWidth =  $('#container').width();

                var animatedArrow = new ScrollMagic.Scene({
                    triggerElement: "#fiscal-impact",
                    duration: 3000/1920*containerWidth,
                    offset: -500/1920*containerWidth
                })
                    .addTo(controller);
                // call startAnimateIt() on start of scene
                animatedArrow.on("enter", function(event) {
                    startAnimateIt();
                });

                var smallGearScene = new ScrollMagic.Scene({
                    triggerElement: "#fiscal-impact",
                    duration: 3000/1920*containerWidth,
                    offset: -500/1920*containerWidth
                })
                    .setTween("#fiscal-impact .gearMedium", { rotation: 750 })
                    .addTo(controller);
                
                var largeGearScene = new ScrollMagic.Scene({
                    triggerElement: "#fiscal-impact",
                    duration: 3050/1920*containerWidth,
                    offset: -500/1920*containerWidth
                })
                    .setTween("#fiscal-impact .gearLarge", { rotation: -440 })
                    .addTo(controller);
                
                var smallGearScene = new ScrollMagic.Scene({
                    triggerElement: "#fiscal-impact",
                    duration: 3000/1920*containerWidth,
                    offset: -500/1920*containerWidth
                })
                    .setTween("#fiscal-impact .gearSmall", { rotation: 550 })
                    .addTo(controller);
            </script>
        </div>
        <div class="middle-container pane" id="the-solution">
            <div>
                <h2 class="solution blue-header">THE SOLUTION</h2>
                <p class="solutionLeft blue-body"></p>
                <script>
                    var numTimesTyped = 0;
                    var typeScene = new ScrollMagic.Scene({
                        triggerElement: "#the-solution",
                        offset: -450/1920*containerWidth
                    })
                        .addTo(controller);
                    typeScene.on("enter", function(event) {
                        numTimesTyped++;
                        if ( numTimesTyped == 2 ) {
                            $(".solutionLeft").qwerty({
                                typerString: "Organizations can avoid paying steep penalties by implementing online safety training programs. These solutions are easy to deploy and net considerable return on investment.",
                                delay: 50
                            });
                        }
                    });
                </script>
                <p class="solutionRight">
                    For example, an enterprise that earns<br />
                    $2 million in annual revenue and<br />
                    invests in 160 hours of web-based<br />
                    safety training per month stands to<br />
                    save more than<br />
                    <span class="big">$1 million</span>
                    over the first three years of use.
                </p>
            </div>
            <img src="assets/left-hand.png" class="leftHand" />
            <img src="assets/right-hand.png" class="rightHand" />

            <script>
                // Let's just tie infinitely looping animation to "wiggle" the hands
                var infiniteLeftHand = anime({
                    targets: ".leftHand",
                    direction: "alternate",
                    loop: true,
                    rotate: function() { return anime.random(-15, 15); },
                    translateX: function() { return anime.random(-1, 1) + "em"; },
                    translateY: "0.5em",
                    easing: "easeInOutSine"
                });

                var infiniteRightHand = anime({
                    targets: ".rightHand",
                    direction: "alternate",
                    loop: true,
                    rotate: -10,
                    translateX: "1em",
                    translateY: "0.5em",
                    easing: "easeInOutSine"
                });
            </script>
        </div>
        <div id="bottom-container" class="pane">
            <div>
                <p class="footerLinks">
                    Sources: <a href="https://www.bls.gov/news.release/pdf/cfoi.pdf">https://www.bls.gov/news.release/pdf/cfoi.pdf</a> | <a href="https://www.bls.gov/iif/oshwc/osh/os/ostb4745.pdf">https://www.bls.gov/iif/oshwc/osh/os/ostb4745.pdf</a> | <a href="http://www.safetyandhealthmagazine.com/articles/14927-2016-oshas-top-10-most-cited-violations">http://www.safetyandhealthmagazine.com/arti<br />cles/14927-2016-oshas-top-10-most-cited-violations</a> | <a href="https://www.osha.gov/oshstats/commonstats.html">https://www.osha.gov/oshstats/commonstats.html</a> | <a href="https://www.osha.gov/penalties">https://www.osha.gov/penalties</a> | <a href="https://www.osha.gov/pls/oshaweb/owadisp.show_document?p_table=NEWS_RELEASES&p_id=32736">https://www.os<br />ha.gov/pls/oshaweb/owadisp.show_document?p_table=NEWS_RELEASES&p_id=32736</a> | <a href="https://www.redvector.com/training-roi">https://www.redvector.com/training-roi</a>
                </p>
            </div>
        </div>
    </div>
</body>
</html>